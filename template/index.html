<!DOCTYPE html>
<html lang="en">
  <head>
    <title> {{ page_title }} </title>
    <link rel="stylesheet" href="css/p.css">
    {% if cookie %}
    <meta http-equiv="Set-Cookie" content="{{ cookie }}">
    {% endif %}
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/p.js"></script>
  </head>

  <body>

    <div id="header">
      <h1> <a href="index.cgi"> {{ page_title }} </a> </h1>
    </div>

    <div id="upload">
      <form id="upload-form" action="index.cgi"
	    method="POST" enctype="multipart/form-data">
	upload: jpg/png/zip
	<input type="file" name="upload-file" accept=".jpg,.png,.zip" multiple>
	User
	<input type="text" name="upload-user" class="uploaded-user"
	       {% if cookie_user %}
	       value="{{ cookie_user }}"
	       {% endif %}
	       >
	<input name="submit" type="submit" value="UpLoad!"> 
      </form>
      

      {% if message %}
      <p> {{ message }} </p>
      <a href="index.cgi"> click: [reload] !!</a>
      {% endif %}

    </div>

    <div id="filter">
      <form id="filter-form" action="index.cgi"
	    method="GET" enctype="multipart/form-data">
	filter: user <select name="filter-user">
	  <option value="_all_"> all </option>
	  {% for filter_user in filter_users %}
	  <option value="{{ filter_user }}"> {{ filter_user }} </option>
	  {% endfor %}
	</select>
	<input name="submit" type="submit" value="Filter!">
	{% if filter_user %}
	filtered by user {{ filter_user }}
	{% endif %}
      </form>
    </div>


    <div id="content" class="clearfix">

      {% for p in photos %}
      <div class="photo-frame">
	<div class="photo">
	  <a href="{{ p.image }}" target="_blank">
	    <img src="{{ p.thumbnail }}"/>
	  </a>
	</div>
	<div class="caption">
	  {% if p.date %}
	  {{ p.date }} {{ p.name }} by {{ p.user }} with {{ p.model }}
	  {% else %}
	  {{ p.name }} by {{ p.user }} (no exif data)
	  {% endif %}
	</div>
      </div>
      {% endfor %}

    </div>

    <div id="footer">
      {{ page_title }}
    </div>

  </body>
</html>
